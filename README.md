<center>

# Мэтчинг товаров.
</center>

**Мэтчинг** — это процесс сопоставления и определения совпадений между двумя или более наборами данных. Мэтчинг 
позволяет автоматически определить правильное соответствие между данными, что позволяет управлять информацией и 
повысить эффективность работы.


### Что надо сделать?

- **Задача.**
    - Разработка алгоритма, который для всех товаров из `validation.csv` предложит 5 вариантов наиболее 
  похожих товаров из `base.csv`.
      <br><br>
- **Метрика.**
    - Необходимо максимизировать метрику `accuracy@5` и оценить по ней качество алгоритма.


**Данные:**

- *base.csv* - анонимизированный набор товаров. Каждый товар представлен как уникальный id и вектор признаков 
размерностью 72.
- *train.csv* - обучающий датасет. Каждая строчка - один товар, для которого известен уникальный id, 
вектор признаков и id товара из *base.csv*, который максимально похож на него (по мнению экспертов).
- *validation.csv* - датасет с товарами (уникальный id и вектор признаков), для которых надо найти наиболее 
близкие товары из *base.csv*
- *validation_answer.csv* - правильные ответы к предыдущему файлу.


### Вывод

Исходные данные имеют хорошее качество. 
Пропуски и дубликаты - отсутствуют. 
Значение целевой метрики `accuracy@5` = *71.797* получено с использованием модели ***FAISS*** с индексом 
***IndexFlatL2***.<br> 
Для работы был выбран индекс ***IndexFlatL2*** в связи с кратно меньшим временем работы, 
в сравнении с индексом ***IndexIVFFlat***, при практически одинаковых показателях метрики. 

| Индекс FAISS  | accuracy@5 | Время (сек.) |
|:--------------|-----------:|-------------:|
| IndexFlatL2   |     71.798 |       239.22 |
| IndexIVFFlat  |     71.797 |      2221.57 |

Масштабирование было выполнено с применением ***RobustScaler***.<br>
Признаки с ненормальным распределением были удалены, за исключением двух признаков, удаление которых оказывало негативное влияние на метрику.
Попытка уменьшить размерность не привела к улучшению результата.





